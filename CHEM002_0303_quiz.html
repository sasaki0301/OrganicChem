<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Chapter 3 ‚Äì Lesson 3 Quiz: Resonance Structures</title>

<style>
  /* === BASE PAGE === */
  body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(135deg, #e8f9f1, #f7faff);
    margin: 0;
    padding: 40px 20px;
    color: #222;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
  }

  /* === QUIZ CONTAINER === */
  .quiz-container {
    background: #ffffff;
    border-radius: 18px;
    padding: 40px 50px;
    box-shadow: 0 8px 28px rgba(0, 0, 0, 0.08);
    width: 95%;
    max-width: 850px;
    text-align: center;
    position: relative;
  }

  h2 {
    color: #136f63;
    margin-bottom: 25px;
    font-size: 1.8em;
  }

  /* === PROGRESS BAR === */
  .progress-wrapper {
    background: #e9f5ef;
    border-radius: 8px;
    height: 14px;
    width: 100%;
    margin-bottom: 25px;
    overflow: hidden;
    box-shadow: inset 0 1px 4px rgba(0,0,0,0.1);
  }
  .progress-bar {
    height: 100%;
    background: linear-gradient(to right, #136f63, #2b7de9);
    width: 0%;
    transition: width 0.4s ease;
    border-radius: 8px;
  }
  .progress-text {
    text-align: right;
    font-size: 0.95em;
    color: #174ea6;
    margin-bottom: 10px;
    font-weight: 600;
  }

  /* === QUESTION + CHOICES === */
  .question {
    font-size: 1.3em;
    font-weight: 600;
    color: #174ea6;
    margin-bottom: 20px;
  }

  .choices {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 25px;
  }

  .choice {
    background: #e8ecf8;
    border: none;
    border-radius: 10px;
    padding: 14px 18px;
    cursor: pointer;
    text-align: left;
    font-size: 1.05em;
    transition: all 0.2s ease;
  }
  .choice:hover { background: #d3dbf8; transform: translateY(-2px); }
  .choice.selected { background: #174ea6; color: #fff; transform: scale(1.02); }

  .explanation {
    background: #eef3ff;
    border-radius: 10px;
    padding: 14px 18px;
    margin-top: 10px;
    display: none;
    text-align: left;
    font-size: 1.05em;
  }

  /* === BUTTONS === */
  .next-btn {
    background: #136f63;
    color: #fff;
    border: none;
    padding: 12px 26px;
    border-radius: 10px;
    font-size: 1.05em;
    cursor: pointer;
    font-weight: bold;
    transition: 0.2s;
    margin-top: 15px;
  }
  .next-btn:hover { background: #0f5b52; }

  /* === RESULT SECTION === */
  .result {
    font-size: 1.4em;
    font-weight: bold;
    color: #174ea6;
    margin-top: 20px;
  }
  .stars {
    font-size: 2.5em;
    margin-top: 10px;
    margin-bottom: 5px;
  }

  .quiz-nav {
    margin-top: 25px;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
  }
  .quiz-btn {
    background: #e8ecf8;
    color: #174ea6;
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 0.95em;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  .quiz-btn:hover { background: #d3dbf8; transform: translateY(-2px); }
  .quiz-btn.primary { background: #136f63; color: #fff; }
  .quiz-btn.primary:hover { background: #0f5b52; }

  @media (max-width: 600px) {
    .quiz-container { padding: 25px; }
    .question { font-size: 1.1em; }
    .stars { font-size: 2em; }
  }
</style>
</head>

<body>

<div class="quiz-container">
  <h2>Lesson 3 Quiz ‚Äì Resonance Structures</h2>

  <div class="progress-text" id="progressText">Question 1 of 10</div>
  <div class="progress-wrapper"><div class="progress-bar" id="progressBar"></div></div>

  <div id="quizBox"></div>
  <button id="nextBtn" class="next-btn" style="display:none;">Next</button>
</div>

<script>
const quizData = [
  {
    q: "1. What does a resonance structure represent?",
    c: [
      "A molecule flipping rapidly between two shapes",
      "One of multiple valid electron arrangements for the same molecule",
      "A different compound with a different molecular formula",
      "A temporary intermediate in a chemical reaction"
    ],
    a: 1,
    e: "Resonance structures are different valid Lewis structures that represent the SAME molecule with delocalized electrons."
  },
  {
    q: "2. Which statement is TRUE about resonance?",
    c: [
      "Atoms move, but electrons stay fixed",
      "Resonance describes electron delocalization, not atom movement",
      "The molecule switches back and forth between structures",
      "Only positively charged molecules show resonance"
    ],
    a: 1,
    e: "In resonance, electron positions change but atom positions remain fixed."
  },
  {
    q: "3. Which of the following can be moved in a resonance structure?",
    c: [
      "œÉ bonds (single bonds)",
      "Atoms in the main skeleton",
      "œÄ bonds and lone pairs",
      "Hybrid orbitals"
    ],
    a: 2,
    e: "Only œÄ bonds and lone pairs can move. œÉ bonds and atoms must remain fixed."
  },
  {
    q: "4. Which is a requirement for drawing valid resonance structures?",
    c: [
      "Each structure must show the same atom arrangement",
      "Each structure must have the same number of electrons, except lone pairs",
      "Each structure must contain only single bonds",
      "Each structure must move atoms to new positions"
    ],
    a: 0,
    e: "Resonance structures must keep the same skeleton; only electrons move."
  },
  {
    q: "5. In the nitrite ion (NO‚ÇÇ‚Åª), why are the two N‚ÄìO bonds the same length?",
    c: [
      "One is a œÉ bond and the other is a œÄ bond",
      "The molecule constantly flips between two structures",
      "Electron delocalization spreads œÄ bond character across both bonds",
      "Nitrogen has no lone pairs"
    ],
    a: 2,
    e: "Resonance causes both N‚ÄìO bonds to have partial double-bond character."
  },
  {
    q: "6. Which factor favors a major resonance contributor?",
    c: [
      "More charges, even if unstable",
      "Negative charge on a less electronegative atom",
      "Atoms lacking full octets",
      "Fewer formal charges and full octets"
    ],
    a: 3,
    e: "Major contributors maximize stability: full octets, minimized charge, and negative charge on electronegative atoms."
  },
  {
    q: "7. Which species is stabilized by allylic resonance?",
    c: [
      "A carbocation next to a double bond",
      "An sp¬≥ carbon with only single bonds",
      "A molecule with no lone pairs",
      "A carbonyl with only œÉ bonds"
    ],
    a: 0,
    e: "Allylic carbocations (next to a C=C) delocalize charge through œÄ-bond shifting."
  },
  {
    q: "8. Why is the acetate ion (CH‚ÇÉCOO‚Åª) especially stable?",
    c: [
      "The negative charge is locked on only one oxygen atom",
      "The carbonyl carbon carries the negative charge",
      "Resonance distributes the negative charge over TWO oxygen atoms",
      "It has more œÉ bonds"
    ],
    a: 2,
    e: "Delocalization of the negative charge over both oxygens greatly stabilizes the ion."
  },
  {
    q: "9. Which of the following is NOT a valid resonance move?",
    c: [
      "Move a lone pair to form a œÄ bond",
      "Move a œÄ bond to an adjacent atom",
      "Break a œÉ bond to separate atoms",
      "Move a œÄ bond to shift charge"
    ],
    a: 2,
    e: "œÉ bonds cannot be broken or moved in resonance."
  },
  {
    q: "10. Which statement best describes the resonance hybrid?",
    c: [
      "The molecule rapidly alternates between structures",
      "It is the weighted average of all valid resonance contributors",
      "It only represents minor contributors",
      "It changes depending on temperature"
    ],
    a: 1,
    e: "The resonance hybrid is the true structure: a blend of all contributors."
  }
];

let current = 0, score = 0, selected = null, showingExplanation = false;

const quizBox = document.getElementById("quizBox");
const nextBtn = document.getElementById("nextBtn");
const progressText = document.getElementById("progressText");
const progressBar = document.getElementById("progressBar");

function showQuestion() {
  const q = quizData[current];
  updateProgress();
  quizBox.innerHTML = `
    <div class='question'>${q.q}</div>
    <div class='choices'></div>
    <div class='explanation' id='explanationBox'></div>
  `;
  const choicesContainer = quizBox.querySelector(".choices");
  q.c.forEach((choice, i) => {
    const btn = document.createElement("button");
    btn.className = "choice";
    btn.innerHTML = choice;
    btn.addEventListener("click", () => selectChoice(i));
    choicesContainer.appendChild(btn);
  });
  nextBtn.style.display = "none";
  selected = null;
  showingExplanation = false;
}

function selectChoice(i) {
  if (showingExplanation) return;
  selected = i;
  document.querySelectorAll(".choice").forEach((btn, idx) => {
    btn.classList.toggle("selected", idx === i);
    btn.disabled = true;
  });
  const q = quizData[current];
  const expBox = document.getElementById("explanationBox");
  const correct = i === q.a;
  if (correct) score++;
  expBox.innerHTML = `<strong>${correct ? "‚úÖ Correct!" : "‚ùå Incorrect."}</strong><br>${q.e}`;
  expBox.style.display = "block";
  nextBtn.style.display = "inline-block";
  showingExplanation = true;
}

nextBtn.addEventListener("click", () => {
  current++;
  if (current < quizData.length) showQuestion();
  else showResult();
});

function updateProgress() {
  const percent = (current / quizData.length) * 100;
  progressBar.style.width = percent + "%";
  progressText.textContent = `Question ${current + 1} of ${quizData.length}`;
}

function getStarRating(percent) {
  if (percent === 100) return "‚≠êÔ∏è‚≠êÔ∏è‚≠êÔ∏è";
  else if (percent >= 90) return "‚≠êÔ∏è‚≠êÔ∏è‚òÜ";
  else if (percent >= 80) return "‚≠êÔ∏è‚òÜ‚òÜ";
  else return "‚òÜ‚òÜ‚òÜ";
}

function showResult() {
  progressBar.style.width = "100%";
  progressText.textContent = "Quiz Completed";
  const percent = Math.round((score / quizData.length) * 100);
  const passed = percent >= 80;

  quizBox.innerHTML = `
    <div class='stars'>${getStarRating(percent)}</div>
    <div class='result'>You scored ${score}/${quizData.length} (${percent}%)</div>
    <div class='quiz-nav'>
      <button class='quiz-btn' id='backBtn'>‚¨Ö Back</button>
      <button class='quiz-btn' id='retryBtn'>üîÅ Retry</button>
      <button class='quiz-btn primary' id='nextLessonBtn' ${passed ? "" : "disabled"}>‚û° Next Lesson</button>
    </div>
  `;

  nextBtn.style.display = "none";
  window.parent.postMessage({ type: "quizResult", score: percent, passed }, "*");

  document.getElementById("retryBtn").addEventListener("click", retryQuiz);
  document.getElementById("backBtn").addEventListener("click", () => 
    window.parent.postMessage({ type: "quizBack" }, "*")
  );
  document.getElementById("nextLessonBtn").addEventListener("click", () => { 
    if (passed) window.parent.postMessage({ type: "quizNextLesson" }, "*"); 
  });
}

function retryQuiz() {
  current = 0;
  score = 0;
  showQuestion();
}

showQuestion();
</script>

</body>
</html>
